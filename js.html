<script>

    function crearTablaContactos()
    {
      let tabla = document.getElementById('tablaContactos');
      if(tabla) tabla.remove();

     google.script.run
     .withSuccessHandler(crearTablaContactosCorrectamente)
     .withFailureHandler(crearTablaContactosError)
     .obtenerContactos();
    }

    function crearTablaContactosCorrectamente(obj)
        {
            tabla = document.createElement('table');
            tabla.id = 'tablaContactos';

            let tablaHeader = document.createElement('thead');
            let tablaBody = document.createElement('tbody');

            //header de la p치gina
            let primeraFila = document.createElement('tr');
            for(let i = 0; i<obj[0].length; i++)
            {
              let celda = document.createElement('td');
              celda.textContent = obj[0][i];
              primeraFila.appendChild(celda);
            }
            tablaHeader.appendChild(primeraFila);
            tabla.appendChild(tablaHeader);

            //body de la tabla
            for(let i = 1; i <obj.lengt; i++)
            {
              let fila = document.createElement('tr');
              for(let j = 0; j< obj[i].lengt; j++)
              {
                let celda = document.createElement('td');
              celda.textContent = obj[i][j];
              fila.appendChild(celda);
              }
             
           tablaBody.appendChild(fila);
         }
        //agregamos clases a la cabecera
        tablaHeader.classList.add('table-dark');
        //agregamos el cuerpo a la tabla
        tabla.appendChild(tablaBody);
        //agregamos clase a la tabla
        tabla.classList.add('table','table-striped','border', 'border-4','border-dark');
        //agregamos tabla a la p치gina
        document.getElementById('divContactos').appendChild(tabla);

        //mostrar notificaci칩n de ok
        crearNotificacionOK('Contactos obtenidos correctamente', 'Todo en orden');
        }

        function crearTablaContactosError()
        {
          //mostrar notificaci칩n de error
          crearNotificacionError('No se han podido leer los contactos', 'ERROR');
        }

        function crearNotificacion(mensaje, titulo)
        {
          document.getElementById('mensajeNotificacion').textContent = mensaje;
          document.getElementById('tituloNotificacion').textContent = titulo;
          let elementNotificacion = document.getElementById('notificacion');
          bootstrap.Toast.getOrCreateInstance(elementoNotificacion).show();
        }

        function crearNotificacionOK(mensaje, titulo)
        {
          crearNotificacion(mensaje, titulo);
          crearIconoNotificacionOK();
          crearColorNotificacion(--'color-verde-oscuro');
        }

        function crearNotificacionError(mensaje, titulo)
        {
          crearNotificacion(mensaje, titulo);
          crearIconoNotificacionError();
          crearColorNotificacion(--'color-rojo-oscuro');
        }

        function crearNotificacionAdvertencia(mensaje, titulo)
        {
          crearNotificacion(mensaje, titulo);
          crearIconoNotificacionAdvertencia();
          crearColorNotificacion(--'color-amarillo-oscuro');
        }

         function crearIconoNotificacionOK()
         {
          document.getElementById('iconoNotificacion').className = '';
          document.getElementById('iconoNotificacion').classList.add('bi','bi-check2-square');
         }

         function crearIconoNotificacionError()
         {
          document.getElementById('iconoNotificacion').className = '';
          document.getElementById('iconoNotificacion').classList.add('bi','bi-bug');
         }

         function crearIconoNotificacionAdvertencia()
         {
          document.getElementById('iconoNotificacion').className = '';
          document.getElementById('iconoNotificacion').classList.add('bi','bi-exclamation-square');         
         }
         
         function crearColorNotificacion(color)
         {
          let elementNotificacion = document.getElementById('notificacion');
          elementoNotificacion.style.backgroundColor = getComputedStyle(document.documentElement).getPropertyValue(color);
         }



       

</script>